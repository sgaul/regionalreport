---
title       : The Regional Report
subtitle    : Living, Working and Learning in Metro Hartford
author      : 
job         : 
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : [parcoords]
ext_widgets : {rCharts: ["libraries/nvd3", "libraries/morris"]} 
mode        : selfcontained # {standalone, draft}

--- &twocol

## Population: Suburbanizing, not urbanizing

*** =left

Until 1940, 50% of the region's population lived in the city of Hartford.  By 2010, only 16% lived in the city. 

Population growth for the region has been slow since 1970 - just 5 percent overall 
between 2000 and 2010. This is driven by continued population loss in Hartford - one third of the population since 1950 - and slow growth in urban periphery towns like West Hartford and Windsor since the 1980s.

*** =right

```{r setup, message = F, echo = F, cache = F}
require(rCharts)
knitr::opts_chunk$set(comment = NA, results = 'asis', tidy = F, message = T)
```
 
 
```{r chart1, echo=FALSE}
n1 <- nPlot(y = 'sumpop', x = 'period', width = 500, height = 425,
            group = 'type',
            data = gh_sum,
            type = 'lineChart')
n1$xAxis(axisLabel='Year')
n1$yAxis(tickFormat = "#!function(d) {return d3.format(',.0f')(d)}!#", axisLabel='Population')
n1$chart(forceY = c(0,700000))
n1$print('chart1')
```

--- .class #id &twocol

## Population: Suburban poverty on the rise

*** =left

The number of people living in poverty in the suburbs of Hartford is now approaching the number living in poverty in the city. 

As of 2010, roughly 40,000 people were living in poverty in Hartford and 37,000 in the suburbs. While poverty has been increasing within Hartford, the city has continued to lose population, leading to one of the highest concentrations of poverty in the country.

At the same time, the number of people living in poverty in the suburbs has increased by 33 percent over the last decade, primarily in East Hartford and Manchester.

*** =right  
 
```{r chart2, echo=FALSE}
n2 <- nPlot(y = 'sumpoor', x = 'period', width = 500, height = 425,
            group = 'type',
            data = subset(gh_sum,period >= 1970),
            type = 'lineChart')
n2$yAxis(tickFormat = "#!function(d) {return d3.format(',.0f')(d)}!#",axisLabel='Population living under poverty line')
n2$chart(forceY = c(0,40000))
n2$xAxis(axisLabel='Year')
n2$print('chart2')
```

--- .class #id 

## Population: More diverse suburbs

While outer ring suburbs, like Tolland and Simsbury, are still predominantly white, there are corridors of diversity through East Hartford and Manchester, north into Bloomfield and Windsor and connecting Hartford and New Britain.

![image](assets/img/diversitymap.png)

--- .class #id 

## Education: Where do our kids go to school?

The Hartford area is characterized by school choice - magnet, charter and private schools draw in 1 in 7 students from the region. Parents choose to go beyond the local school system more often in higher grades and in towns with higher income inequality. In Bloomfield, for instance, 50 percent of parents send their children to magnet or private schools by 10th grade. 

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5.5}
ggplot(data = subset(enroll, School.Year == "2010-11" & variable != "Total"), 
       aes(x = variable, y = x, group = School.Type, fill = School.Type)) +
  geom_area(aes(order = as.numeric(School.Type)), position = "fill") +
  scale_y_continuous(labels = percent) +
  scale_x_discrete(breaks = c("K","G3","G6","G9","G12")) +
  labs(x = NULL, y = NULL) +
  scale_fill_brewer() +
  theme_minimal() +
  theme(strip.text.x = element_text(size = 12)) +
  facet_wrap(~ Resident.Town, ncol = 8)
```

--- .class #id 

## Education: Educational inequities through school

Suburban schools are among the best performing in the state at all grade levels. While the level of pre-K experience varies greatly across districts, urban and urban periphery districts with underperforming schools fall behind by third grade and largely remain there until graduation.


```{r chart4, echo = FALSE}
#Used solution from this gist for now: https://gist.github.com/ramnathv/1fcf50751e461b9192ac
pctest <- subset(parcoords[1:8], HSGrad != "NA" & Kindergarten != "NA")
p1 <- rCharts$new()
p1$setLib('libraries/widgets/parcoords')
#p1$field('lib', 'libraries/widgets/parcoords')
p1$set(padding = list(top = 24, left = 200, bottom = 12, right = 200), 
       height = "425", width = "1200")
p1$set(data = toJSONArray(pctest[1:7], json = F), 
       range = c(60,100),
       colorby = 'HSGrad',
       colors = c('steelblue', 'brown'))
p1$save('test.html', cdn = TRUE)
```
 
<iframe src='test.html'></iframe>

--- .class #id 

## Workforce: A regional workforce, Hartford-centered

Most towns in the region have a high percentage of commuters â€“ over 75 percent in every town except Hartford. One in five workers (70,000 individuals) commute to Hartford, while Enfield, Manchester and Simsbury also act as local hubs for employment.

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=6}
ggplot(data = commutemap) + 
  geom_map(aes(map_id = id, fill = ratio), map = CTTowns) +
  geom_path(data = CTTowns, aes(x = long, y = lat, group = group),alpha = 0.05) +
  labs(x = NULL, y = NULL) +
  scale_x_continuous(breaks = NULL) +
  scale_y_continuous(breaks = NULL) +
  theme_minimal() +
  scale_fill_gradientn(colours = brewer.pal(4, "Blues"), name = "% of workers\n commuting to\n destination") +
  expand_limits(x = CTTowns$long, y = CTTowns$lat) +
  theme(strip.text.x = element_text(size = 12)) +
  facet_wrap(~ Starting.point, ncol = 8)  
```

--- .class #id 

## Workforce: Commuting alone

For those that do commute, driving alone is an increasingly frequent means of transport, instead of alternatives like carpooling, public transit or walking. As of 2000, 83 percent drove to work alone (compared to 67 percent in 1980), one of the highest rates compared to other metro areas in the country. 

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=13, fig.height=5.5} 
ggplot(data = walk, aes(x = Year, y = value)) + 
  geom_line(aes(group = Area), alpha = 0.15) + 
  geom_line(data = subset(walk, Area == "Hartford"), aes(x = Year, y = value), colour = "blue", size = 1) + 
  theme_minimal() +
  scale_x_continuous(breaks = c(1980,1990,2000)) +
  labs(x = NULL, y = "Percent of commuters") +
  theme(strip.text.x = element_text(size =12)) +
  facet_grid(. ~ variable)
```

--- .class #id 

## Workforce: Persistent gaps in employment

Hartford has had higher-than-average unemployment for the past decade. In addition, some urban periphery and rural towns, like East Hartford, Bloomfield and East Windsor have also experienced higher than average rates of unemployment. The gap between these towns and the rest of the region has widened, as most suburban towns have experienced relatively low unemployment.

```{r chart3, echo=FALSE}
ue <- ddply(merge(lausann,towns, by = "Town"),
      .(Towngroup, Year), 
      summarise, 
      RT = weighted.mean(RT, LF, na.rm = TRUE))
n3 <- nPlot(y = 'RT', x = 'Year', width = 800, height = 425,
            group = 'Towngroup',
            data = ue,
            type = 'lineChart')
n3$yAxis(axisLabel='Unemployment rate')
n3$chart(forceY = c(0,17))
n3$show('inline')
```

--- .class #id &twocol

## Basic needs: What are the needs in our region?

*** =left

Housing and shelter continue to be the greatest needs for 211 infoline callers. 

While demand for information services, utilities assistance and legal services has declined, basic needs such as food and public assistance have seen recent increases. 

As with the poverty figures, the volume of calls from the suburbs is similar to that from Hartford in most areas. 

*** =right

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=7, fig.height=7.5}
combine$Service <- reorder(combine$Service, -combine$value)
ggplot(data = subset(combine, Year<2013 & !Service %in% c("Community Services","Personal/Household Goods","Employment and Training Programs","Tax Organizations and Services","Individual and Family Support Services")), 
       aes(x=Year, y=value, group=variable)) + 
  geom_line(aes(color = variable)) +
  labs(x = NULL, y = "Number of 211 calls") + 
  scale_y_continuous(breaks = c(0,5000,10000)) +
  scale_x_continuous(breaks = c(2009,2011)) +
  guides(colour = guide_legend(NULL)) +
  facet_wrap(~ Service, ncol = 2) + 
  theme(strip.text.x = element_text(size =8)) +
  theme_minimal()
```


--- .class #id 

## Opportunities

There are several areas that we would like to know more about, but where we lack the data for reliable indicators. In some cases, work is already being done to address these gaps.

- Adult literacy: while our headline results are alarming, this data is over 20 years old and needs a refresh. 
- Children's development at kindergarten: High-quality data on development of the 'whole child' by kindergarten can help schools, but also communities to address needs before age 5. A pilot of the Early Development Instrument will help us learn more. 



